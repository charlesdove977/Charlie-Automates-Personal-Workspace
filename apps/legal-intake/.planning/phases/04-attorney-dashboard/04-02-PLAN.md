---
phase: 04-attorney-dashboard
plan: 02
type: execute
---

<objective>
Build the dashboard shell and case inbox view.

Purpose: Attorneys need to see their pending cases at a glance and quickly identify which need attention.
Output: Dashboard layout with sidebar navigation and filterable case inbox list.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-attorney-dashboard/04-01-SUMMARY.md

@prisma/schema.prisma
@src/lib/db.ts
@src/lib/auth.ts
@src/types/case-brief.ts

**Tech stack available:** Next.js 16, Prisma 7, Tailwind CSS
**Established patterns:** Multi-tenant by firmId, force-dynamic for DB pages, API routes with Cache-Control
**Constraining decisions:**
- Phase 02-02: force-dynamic export for firm pages (database queries)
- ProcessingStatus enum: QUEUED, EXTRACTING, ANALYZING, COMPLETE, FAILED
- CaseStatus enum: PENDING, ACCEPTED, REJECTED

**Data model:**
Case has: id, firmId, status (PENDING/ACCEPTED/REJECTED), clientName, clientEmail, caseType, jurisdiction, briefJson, fitScore, processingStatus, submittedAt
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create dashboard layout with sidebar navigation</name>
  <files>src/app/dashboard/layout.tsx, src/components/dashboard/Sidebar.tsx, src/components/dashboard/Header.tsx</files>
  <action>
Create dashboard layout component:
- Left sidebar (fixed, ~250px width) with navigation links:
  - Inbox (case list) - primary
  - Settings (placeholder for Phase 5)
- Top header with:
  - Firm name (from session)
  - User name + role
  - Logout button
- Main content area (flex-1, scrollable)

Sidebar styling:
- Dark blue background (#1a365d - matches primaryColor default)
- White text, hover states
- Active link indicator
- Firm logo placeholder at top

Responsive: On mobile, sidebar becomes hamburger menu (stretch goal, basic desktop-first OK).

Use existing auth session to get firmId and query firm name.
  </action>
  <verify>Visit /dashboard → see sidebar + header, navigation links work</verify>
  <done>Dashboard shell renders with navigation, user info displays correctly</done>
</task>

<task type="auto">
  <name>Task 2: Build case inbox list with filtering</name>
  <files>src/app/dashboard/page.tsx, src/components/dashboard/CaseList.tsx, src/components/dashboard/CaseCard.tsx, src/app/api/dashboard/cases/route.ts</files>
  <action>
Create GET /api/dashboard/cases endpoint:
- Requires auth (check session)
- Filter by firmId from session (multi-tenant isolation)
- Query params: status (pending/accepted/rejected/all), limit, offset
- Return cases with: id, clientName, clientEmail, caseType, jurisdiction, fitScore, processingStatus, submittedAt, status
- Order by submittedAt DESC (newest first)
- Include count for pagination

Create dashboard home page (/dashboard):
- Fetch cases from API
- Filter tabs: All | Pending | Accepted | Rejected
- Default to Pending tab

Create CaseList component:
- Map cases to CaseCard components
- Empty state: "No cases found"
- Loading state with skeleton

Create CaseCard component:
- Client name (primary)
- Case type + jurisdiction
- Submitted date (relative: "2 hours ago")
- Fit score badge (color-coded: green ≥70, yellow 50-69, red <50)
- Processing status indicator (spinner if not COMPLETE, error icon if FAILED)
- Click → navigate to /dashboard/cases/[caseId]

Styling: Professional table-like cards, hover states, subtle shadows.
  </action>
  <verify>
- /dashboard shows case list
- Filter tabs work (Pending/Accepted/Rejected/All)
- Cases display with correct info
- Clicking case navigates to detail page (404 OK for now)
  </verify>
  <done>Case inbox displays, filtering works, cards show key info</done>
</task>

<task type="auto">
  <name>Task 3: Add processing status indicators and auto-refresh</name>
  <files>src/components/dashboard/ProcessingBadge.tsx, src/components/dashboard/CaseCard.tsx, src/app/dashboard/page.tsx</files>
  <action>
Create ProcessingBadge component:
- QUEUED: Gray badge "Queued"
- EXTRACTING: Blue badge with spinner "Extracting..."
- ANALYZING: Blue badge with spinner "Analyzing..."
- COMPLETE: Green badge "Ready"
- FAILED: Red badge "Failed" with tooltip showing processingError

Update CaseCard to use ProcessingBadge.

Add auto-refresh to dashboard:
- If any visible cases have processingStatus !== COMPLETE and !== FAILED
- Poll /api/dashboard/cases every 5 seconds
- Stop polling when all cases complete or page unmounts
- Use React useEffect with cleanup

This allows attorneys to see cases move through processing in real-time.
  </action>
  <verify>
- Processing badges show correct status
- Page auto-refreshes when cases are processing
- Refresh stops when all cases are COMPLETE or FAILED
  </verify>
  <done>Processing status visible, auto-refresh works for in-progress cases</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Dashboard layout renders with sidebar and header
- [ ] Case list loads and displays cases
- [ ] Filter tabs work correctly
- [ ] Fit score badges show with correct colors
- [ ] Processing status badges update appropriately
- [ ] Auto-refresh works for processing cases
- [ ] `pnpm build` passes
</verification>

<success_criteria>
- Dashboard shell is complete and professional
- Cases display with all key information
- Filtering by status works
- Processing status is clearly visible
- Multi-tenant isolation maintained (only firm's cases shown)
- No TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/04-attorney-dashboard/04-02-SUMMARY.md`
</output>
